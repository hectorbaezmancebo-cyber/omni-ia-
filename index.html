<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>OMNI-IA — Sistema de Inteligencia Personal</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;400;600&family=Share+Tech+Mono&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #030508;
    --surface: rgba(0,255,200,0.03);
    --border: rgba(0,255,200,0.12);
    --cyan: #00ffc8;
    --cyan2: #00b8ff;
    --gold: #ffd700;
    --red: #ff3860;
    --text: #c8f0ff;
    --muted: rgba(200,240,255,0.4);
    --glow: 0 0 20px rgba(0,255,200,0.3);
  }

  * { margin:0; padding:0; box-sizing:border-box; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'Rajdhani', sans-serif;
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* GRID BG */
  body::before {
    content:'';
    position:fixed; inset:0; z-index:0;
    background-image:
      linear-gradient(rgba(0,255,200,0.04) 1px, transparent 1px),
      linear-gradient(90deg, rgba(0,255,200,0.04) 1px, transparent 1px);
    background-size: 40px 40px;
    pointer-events:none;
  }

  /* SCAN LINE */
  body::after {
    content:'';
    position:fixed; inset:0; z-index:1;
    background: repeating-linear-gradient(
      0deg,
      transparent,
      transparent 2px,
      rgba(0,0,0,0.08) 2px,
      rgba(0,0,0,0.08) 4px
    );
    pointer-events:none;
  }

  .app { position:relative; z-index:2; display:flex; height:100vh; }

  /* ══ SIDEBAR ══ */
  .sidebar {
    width: 72px;
    background: rgba(0,255,200,0.03);
    border-right: 1px solid var(--border);
    display:flex; flex-direction:column; align-items:center;
    padding: 20px 0; gap: 8px;
    position:relative; z-index:10;
  }

  .logo {
    font-family:'Orbitron', sans-serif;
    font-size: 10px;
    color: var(--cyan);
    letter-spacing:2px;
    writing-mode: vertical-rl;
    text-orientation: mixed;
    transform: rotate(180deg);
    padding: 12px 0;
    margin-bottom:16px;
    text-shadow: var(--glow);
  }

  .nav-btn {
    width:44px; height:44px;
    background: transparent;
    border: 1px solid transparent;
    border-radius: 8px;
    color: var(--muted);
    cursor:pointer;
    display:flex; align-items:center; justify-content:center;
    font-size:18px;
    transition: all 0.2s;
    position:relative;
  }
  .nav-btn:hover, .nav-btn.active {
    background: rgba(0,255,200,0.08);
    border-color: var(--border);
    color: var(--cyan);
    box-shadow: var(--glow);
  }
  .nav-btn.active::before {
    content:'';
    position:absolute; left:-1px;
    width:3px; height:60%;
    background: var(--cyan);
    border-radius:0 2px 2px 0;
    box-shadow: 0 0 8px var(--cyan);
  }

  .nav-tooltip {
    position:absolute; left:56px;
    background: rgba(3,5,8,0.95);
    border:1px solid var(--border);
    padding:4px 10px;
    border-radius:4px;
    font-size:11px;
    white-space:nowrap;
    opacity:0; pointer-events:none;
    transition:opacity 0.2s;
    color: var(--cyan);
    font-family:'Share Tech Mono', monospace;
  }
  .nav-btn:hover .nav-tooltip { opacity:1; }

  /* ══ MAIN ══ */
  .main { flex:1; display:flex; flex-direction:column; overflow:hidden; }

  /* TOPBAR */
  .topbar {
    height:52px;
    border-bottom:1px solid var(--border);
    display:flex; align-items:center;
    padding: 0 24px; gap:16px;
    background: rgba(0,255,200,0.02);
  }
  .topbar-title {
    font-family:'Orbitron', sans-serif;
    font-size:13px; font-weight:700;
    color: var(--cyan);
    letter-spacing:3px;
    text-shadow: var(--glow);
    flex:1;
  }
  .status-dot {
    width:8px; height:8px; border-radius:50%;
    background: var(--cyan);
    box-shadow: 0 0 10px var(--cyan);
    animation: pulse-dot 2s infinite;
  }
  @keyframes pulse-dot { 0%,100%{opacity:1} 50%{opacity:0.3} }
  .status-label {
    font-family:'Share Tech Mono',monospace;
    font-size:10px; color:var(--muted);
    letter-spacing:1px;
  }

  .api-badge {
    background: rgba(255,215,0,0.1);
    border:1px solid rgba(255,215,0,0.3);
    border-radius:4px;
    padding: 3px 10px;
    font-size:10px;
    font-family:'Share Tech Mono',monospace;
    color: var(--gold);
    cursor:pointer;
    transition:all 0.2s;
  }
  .api-badge:hover {
    background: rgba(255,215,0,0.2);
    box-shadow: 0 0 12px rgba(255,215,0,0.3);
  }

  /* SCREENS */
  .screen { display:none; flex:1; overflow:hidden; }
  .screen.active { display:flex; }

  /* ══ SCREEN: CORE (ORB) ══ */
  #screen-core {
    flex-direction:column;
    align-items:center;
    justify-content:center;
    position:relative;
    gap: 32px;
  }

  .orb-container { position:relative; }

  .orb-ring {
    position:absolute; inset:-30px;
    border-radius:50%;
    border:1px solid rgba(0,255,200,0.15);
    animation: ring-spin 8s linear infinite;
  }
  .orb-ring:nth-child(2) {
    inset:-50px;
    border-color: rgba(0,184,255,0.1);
    animation-duration:12s;
    animation-direction:reverse;
  }
  @keyframes ring-spin { from{transform:rotate(0)} to{transform:rotate(360deg)} }

  .orb {
    width:160px; height:160px;
    border-radius:50%;
    background: radial-gradient(circle at 35% 35%,
      rgba(255,255,255,0.9),
      var(--cyan) 30%,
      var(--cyan2) 55%,
      #001020 80%
    );
    box-shadow:
      0 0 40px rgba(0,255,200,0.5),
      0 0 80px rgba(0,255,200,0.2),
      0 0 120px rgba(0,184,255,0.1),
      inset 0 0 30px rgba(0,255,200,0.2);
    animation: orb-breathe 3s ease-in-out infinite;
    cursor:pointer;
    transition: transform 0.3s;
  }
  .orb:hover { transform:scale(1.05); }
  .orb.listening {
    animation: orb-listen 0.8s ease-in-out infinite;
    box-shadow:
      0 0 60px rgba(0,255,200,0.8),
      0 0 100px rgba(0,255,200,0.4);
  }
  @keyframes orb-breathe {
    0%,100%{transform:scale(1)}
    50%{transform:scale(1.08)}
  }
  @keyframes orb-listen {
    0%,100%{transform:scale(1)}
    50%{transform:scale(1.15)}
  }

  .orb-label {
    font-family:'Orbitron', monospace;
    font-size:11px; letter-spacing:4px;
    color: var(--muted);
    text-align:center;
  }
  .orb-status {
    font-family:'Share Tech Mono',monospace;
    font-size:13px;
    color: var(--cyan);
    text-align:center;
    text-shadow: var(--glow);
    min-height:20px;
  }

  .voice-input-area {
    display:flex; gap:12px; align-items:center;
    width:100%; max-width:580px; padding:0 24px;
  }
  .voice-input {
    flex:1;
    background: rgba(0,255,200,0.04);
    border: 1px solid var(--border);
    border-radius:8px;
    padding:12px 16px;
    color: var(--text);
    font-family:'Rajdhani',sans-serif;
    font-size:15px;
    outline:none;
    transition:border-color 0.2s;
  }
  .voice-input:focus { border-color: var(--cyan); box-shadow: var(--glow); }
  .voice-input::placeholder { color:var(--muted); }

  .send-btn {
    width:46px; height:46px;
    background: rgba(0,255,200,0.1);
    border:1px solid var(--cyan);
    border-radius:8px;
    color: var(--cyan);
    font-size:18px;
    cursor:pointer;
    transition:all 0.2s;
    display:flex; align-items:center; justify-content:center;
  }
  .send-btn:hover {
    background: rgba(0,255,200,0.2);
    box-shadow: var(--glow);
    transform:scale(1.05);
  }

  .core-response {
    width:100%; max-width:580px; padding:0 24px;
    max-height:200px; overflow-y:auto;
  }
  .response-box {
    background: rgba(0,255,200,0.04);
    border:1px solid var(--border);
    border-radius:8px;
    padding:16px;
    font-size:14px; line-height:1.7;
    color: var(--text);
    display:none;
    white-space:pre-wrap;
  }
  .response-box.visible { display:block; }

  /* ══ SCREEN: CHAT ══ */
  #screen-chat { flex-direction:column; }

  .chat-header {
    padding:16px 24px;
    border-bottom:1px solid var(--border);
    display:flex; align-items:center; gap:12px;
  }
  .personality-selector {
    display:flex; gap:8px;
  }
  .persona-btn {
    padding:4px 14px;
    background:transparent;
    border:1px solid var(--border);
    border-radius:20px;
    color:var(--muted);
    font-size:11px;
    font-family:'Share Tech Mono',monospace;
    cursor:pointer;
    transition:all 0.2s;
  }
  .persona-btn.active, .persona-btn:hover {
    border-color: var(--cyan);
    color: var(--cyan);
    background: rgba(0,255,200,0.08);
  }

  .chat-messages {
    flex:1; overflow-y:auto;
    padding:20px 24px;
    display:flex; flex-direction:column; gap:16px;
  }
  .chat-messages::-webkit-scrollbar { width:4px; }
  .chat-messages::-webkit-scrollbar-track { background:transparent; }
  .chat-messages::-webkit-scrollbar-thumb { background:var(--border); border-radius:2px; }

  .msg {
    max-width:80%;
    padding:12px 16px;
    border-radius:8px;
    font-size:14px; line-height:1.7;
    white-space:pre-wrap;
  }
  .msg.user {
    align-self:flex-end;
    background: rgba(0,184,255,0.1);
    border:1px solid rgba(0,184,255,0.3);
    color: var(--text);
  }
  .msg.ai {
    align-self:flex-start;
    background: rgba(0,255,200,0.05);
    border:1px solid var(--border);
    color: var(--text);
  }
  .msg.ai .msg-sender {
    font-family:'Share Tech Mono',monospace;
    font-size:10px;
    color: var(--cyan);
    margin-bottom:6px;
    letter-spacing:1px;
  }
  .msg.thinking {
    align-self:flex-start;
    background: rgba(0,255,200,0.03);
    border:1px solid var(--border);
    color: var(--muted);
    font-family:'Share Tech Mono',monospace;
    font-size:12px;
  }

  .chat-input-area {
    padding:16px 24px;
    border-top:1px solid var(--border);
    display:flex; gap:12px;
  }
  .chat-input {
    flex:1;
    background: rgba(0,255,200,0.04);
    border:1px solid var(--border);
    border-radius:8px;
    padding:12px 16px;
    color:var(--text);
    font-family:'Rajdhani',sans-serif;
    font-size:15px;
    outline:none;
    resize:none;
    height:46px;
    transition:border-color 0.2s;
  }
  .chat-input:focus { border-color:var(--cyan); box-shadow:var(--glow); }
  .chat-input::placeholder { color:var(--muted); }

  /* ══ SCREEN: DOCS ══ */
  #screen-docs { flex-direction:column; gap:0; }

  .docs-toolbar {
    padding:12px 24px;
    border-bottom:1px solid var(--border);
    display:flex; gap:8px; align-items:center; flex-wrap:wrap;
  }
  .tool-btn {
    padding:5px 14px;
    background:transparent;
    border:1px solid var(--border);
    border-radius:4px;
    color:var(--muted);
    font-size:12px;
    font-family:'Share Tech Mono',monospace;
    cursor:pointer;
    transition:all 0.2s;
  }
  .tool-btn:hover {
    border-color:var(--cyan);
    color:var(--cyan);
    background:rgba(0,255,200,0.06);
  }
  .tool-sep { width:1px; height:24px; background:var(--border); margin:0 4px; }

  .docs-main {
    flex:1; display:flex; overflow:hidden;
  }
  .docs-sidebar-panel {
    width:220px;
    border-right:1px solid var(--border);
    padding:16px;
    overflow-y:auto;
  }
  .docs-sidebar-panel h4 {
    font-size:10px; letter-spacing:2px;
    color:var(--muted);
    font-family:'Share Tech Mono',monospace;
    margin-bottom:12px;
  }
  .doc-type-btn {
    display:block; width:100%;
    text-align:left;
    padding:8px 12px;
    background:transparent;
    border:1px solid transparent;
    border-radius:4px;
    color:var(--muted);
    font-size:13px;
    cursor:pointer;
    transition:all 0.2s;
    margin-bottom:4px;
  }
  .doc-type-btn:hover, .doc-type-btn.active {
    background:rgba(0,255,200,0.06);
    border-color:var(--border);
    color:var(--cyan);
  }

  .docs-editor-area {
    flex:1; display:flex; flex-direction:column; padding:24px; gap:12px;
  }
  .doc-prompt-input {
    background:rgba(0,255,200,0.04);
    border:1px solid var(--border);
    border-radius:8px;
    padding:12px 16px;
    color:var(--text);
    font-family:'Rajdhani',sans-serif;
    font-size:15px;
    outline:none;
    resize:none;
    height:80px;
    transition:border-color 0.2s;
  }
  .doc-prompt-input:focus { border-color:var(--cyan); }
  .doc-prompt-input::placeholder { color:var(--muted); }

  .doc-output {
    flex:1;
    background:rgba(0,255,200,0.02);
    border:1px solid var(--border);
    border-radius:8px;
    padding:20px;
    overflow-y:auto;
    font-size:14px;
    line-height:1.8;
    color:var(--text);
    white-space:pre-wrap;
    font-family:'Rajdhani',sans-serif;
  }
  .doc-output.empty {
    display:flex; align-items:center; justify-content:center;
    color:var(--muted);
    font-family:'Share Tech Mono',monospace;
    font-size:12px;
  }

  .generate-btn {
    padding:10px 28px;
    background:rgba(0,255,200,0.1);
    border:1px solid var(--cyan);
    border-radius:6px;
    color:var(--cyan);
    font-family:'Orbitron',sans-serif;
    font-size:11px;
    letter-spacing:2px;
    cursor:pointer;
    transition:all 0.2s;
    align-self:flex-start;
  }
  .generate-btn:hover {
    background:rgba(0,255,200,0.2);
    box-shadow:var(--glow);
  }

  /* ══ SCREEN: IMAGE ══ */
  #screen-image { flex-direction:column; padding:24px; gap:20px; }

  .image-controls {
    display:flex; gap:12px; align-items:flex-start; flex-wrap:wrap;
  }
  .image-prompt-input {
    flex:1; min-width:200px;
    background:rgba(0,255,200,0.04);
    border:1px solid var(--border);
    border-radius:8px;
    padding:12px 16px;
    color:var(--text);
    font-family:'Rajdhani',sans-serif;
    font-size:15px;
    outline:none;
    resize:none;
    height:80px;
    transition:border-color 0.2s;
  }
  .image-prompt-input:focus { border-color:var(--cyan); }
  .image-prompt-input::placeholder { color:var(--muted); }

  .image-styles {
    display:flex; flex-wrap:wrap; gap:6px;
  }
  .style-chip {
    padding:5px 12px;
    background:transparent;
    border:1px solid var(--border);
    border-radius:20px;
    color:var(--muted);
    font-size:11px;
    cursor:pointer;
    transition:all 0.2s;
    font-family:'Share Tech Mono',monospace;
  }
  .style-chip.active, .style-chip:hover {
    border-color:var(--gold);
    color:var(--gold);
    background:rgba(255,215,0,0.06);
  }

  .image-result {
    flex:1;
    border:1px solid var(--border);
    border-radius:8px;
    background:rgba(0,255,200,0.02);
    display:flex; align-items:center; justify-content:center;
    overflow:hidden; position:relative;
    min-height:200px;
  }
  .image-placeholder {
    text-align:center;
    color:var(--muted);
    font-family:'Share Tech Mono',monospace;
    font-size:12px;
  }
  .image-placeholder .icon { font-size:48px; margin-bottom:12px; opacity:0.3; }

  /* ══ SCREEN: FINANCE ══ */
  #screen-finance { flex-direction:column; padding:24px; gap:20px; overflow-y:auto; }

  .finance-grid {
    display:grid;
    grid-template-columns:repeat(auto-fit, minmax(200px,1fr));
    gap:12px;
  }
  .finance-card {
    background:rgba(0,255,200,0.03);
    border:1px solid var(--border);
    border-radius:8px;
    padding:16px;
  }
  .finance-card h4 {
    font-size:10px;
    letter-spacing:2px;
    color:var(--muted);
    font-family:'Share Tech Mono',monospace;
    margin-bottom:8px;
  }
  .finance-card .value {
    font-family:'Orbitron',sans-serif;
    font-size:22px;
    color:var(--cyan);
    text-shadow:var(--glow);
  }
  .finance-card .change {
    font-size:12px;
    margin-top:4px;
    color:var(--muted);
  }
  .change.up { color:#00ff88; }
  .change.down { color:var(--red); }

  .finance-advice-area {
    display:flex; flex-direction:column; gap:12px;
  }
  .finance-advice-area textarea {
    background:rgba(0,255,200,0.04);
    border:1px solid var(--border);
    border-radius:8px;
    padding:12px 16px;
    color:var(--text);
    font-family:'Rajdhani',sans-serif;
    font-size:15px;
    outline:none;
    resize:none;
    height:80px;
  }
  .finance-advice-area textarea:focus { border-color:var(--cyan); }
  .finance-advice-area textarea::placeholder { color:var(--muted); }

  .finance-output {
    background:rgba(0,255,200,0.02);
    border:1px solid var(--border);
    border-radius:8px;
    padding:16px;
    min-height:120px;
    font-size:14px;
    line-height:1.7;
    color:var(--text);
    white-space:pre-wrap;
  }

  /* ══ SCREEN: TRANSLATE ══ */
  #screen-translate { padding:24px; flex-direction:column; gap:20px; }

  .translate-grid {
    display:grid; grid-template-columns:1fr 1fr; gap:16px; flex:1;
  }
  .translate-panel {
    display:flex; flex-direction:column; gap:8px;
  }
  .lang-select {
    background:rgba(0,255,200,0.04);
    border:1px solid var(--border);
    border-radius:6px;
    padding:8px 12px;
    color:var(--text);
    font-family:'Share Tech Mono',monospace;
    font-size:12px;
    outline:none;
    cursor:pointer;
  }
  .lang-select option { background:#030508; color:var(--text); }
  .translate-text {
    flex:1; min-height:200px;
    background:rgba(0,255,200,0.04);
    border:1px solid var(--border);
    border-radius:8px;
    padding:16px;
    color:var(--text);
    font-family:'Rajdhani',sans-serif;
    font-size:15px;
    outline:none;
    resize:none;
    transition:border-color 0.2s;
  }
  .translate-text:focus { border-color:var(--cyan); }
  .translate-text::placeholder { color:var(--muted); }
  .translate-output {
    flex:1; min-height:200px;
    background:rgba(0,255,200,0.02);
    border:1px solid var(--border);
    border-radius:8px;
    padding:16px;
    color:var(--text);
    font-size:15px;
    overflow-y:auto;
    white-space:pre-wrap;
    line-height:1.7;
  }

  /* ══ API MODAL ══ */
  .modal-overlay {
    display:none; position:fixed; inset:0; z-index:100;
    background:rgba(0,0,0,0.8);
    align-items:center; justify-content:center;
  }
  .modal-overlay.open { display:flex; }
  .modal {
    background:#080e14;
    border:1px solid var(--border);
    border-radius:12px;
    padding:28px;
    width:440px;
    box-shadow:0 0 40px rgba(0,255,200,0.15);
  }
  .modal h3 {
    font-family:'Orbitron',sans-serif;
    font-size:14px;
    color:var(--cyan);
    letter-spacing:3px;
    margin-bottom:8px;
  }
  .modal p {
    font-size:13px;
    color:var(--muted);
    margin-bottom:16px;
    line-height:1.6;
  }
  .modal a { color:var(--cyan); }
  .modal input {
    width:100%;
    background:rgba(0,255,200,0.04);
    border:1px solid var(--border);
    border-radius:6px;
    padding:10px 14px;
    color:var(--text);
    font-family:'Share Tech Mono',monospace;
    font-size:13px;
    outline:none;
    margin-bottom:16px;
  }
  .modal input:focus { border-color:var(--cyan); }
  .modal-btns { display:flex; gap:10px; justify-content:flex-end; }
  .modal-cancel {
    padding:8px 20px;
    background:transparent;
    border:1px solid var(--border);
    border-radius:6px;
    color:var(--muted);
    cursor:pointer;
    font-size:13px;
  }
  .modal-save {
    padding:8px 20px;
    background:rgba(0,255,200,0.1);
    border:1px solid var(--cyan);
    border-radius:6px;
    color:var(--cyan);
    cursor:pointer;
    font-size:13px;
    font-family:'Orbitron',sans-serif;
    letter-spacing:1px;
  }
  .modal-save:hover { background:rgba(0,255,200,0.2); box-shadow:var(--glow); }

  /* LOADING DOT ANIMATION */
  .thinking-dots::after {
    content:'';
    animation: dots 1.2s infinite;
  }
  @keyframes dots {
    0%{content:'.'}
    33%{content:'..'}
    66%{content:'...'}
    100%{content:''}
  }

  /* SCROLLBAR */
  ::-webkit-scrollbar { width:4px; height:4px; }
  ::-webkit-scrollbar-track { background:transparent; }
  ::-webkit-scrollbar-thumb { background:var(--border); border-radius:2px; }

  /* RESPONSIVE */
  @media(max-width:600px) {
    .sidebar { width:52px; }
    .translate-grid { grid-template-columns:1fr; }
  }

  .section-title {
    font-family:'Orbitron',sans-serif;
    font-size:11px;
    letter-spacing:3px;
    color:var(--muted);
    margin-bottom:16px;
  }

  .copy-btn {
    padding:5px 14px;
    background:transparent;
    border:1px solid var(--border);
    border-radius:4px;
    color:var(--muted);
    font-size:11px;
    font-family:'Share Tech Mono',monospace;
    cursor:pointer;
    transition:all 0.2s;
  }
  .copy-btn:hover { border-color:var(--gold); color:var(--gold); }
</style>
</head>
<body>

<div class="app">
  <!-- SIDEBAR -->
  <aside class="sidebar">
    <div class="logo">OMNI·IA</div>

    <button class="nav-btn active" onclick="showScreen('core')" id="nav-core">
      ◎
      <span class="nav-tooltip">NÚCLEO</span>
    </button>
    <button class="nav-btn" onclick="showScreen('chat')" id="nav-chat">
      ◈
      <span class="nav-tooltip">CONSEJERA</span>
    </button>
    <button class="nav-btn" onclick="showScreen('docs')" id="nav-docs">
      ◧
      <span class="nav-tooltip">DOCUMENTOS</span>
    </button>
    <button class="nav-btn" onclick="showScreen('image')" id="nav-image">
      ◉
      <span class="nav-tooltip">IMÁGENES IA</span>
    </button>
    <button class="nav-btn" onclick="showScreen('finance')" id="nav-finance">
      ◬
      <span class="nav-tooltip">FINANZAS</span>
    </button>
    <button class="nav-btn" onclick="showScreen('translate')" id="nav-translate">
      ◐
      <span class="nav-tooltip">TRADUCCIÓN</span>
    </button>
  </aside>

  <!-- MAIN CONTENT -->
  <main class="main">
    <!-- TOPBAR -->
    <div class="topbar">
      <div class="topbar-title" id="topbar-title">NÚCLEO DE INTERACCIÓN</div>
      <div class="status-dot"></div>
      <span class="status-label">SISTEMA ACTIVO</span>
      <div class="api-badge" onclick="openModal()">⚙ API KEY</div>
    </div>

    <!-- ══ SCREEN: CORE ══ -->
    <div class="screen active" id="screen-core">
      <div class="orb-container">
        <div class="orb-ring"></div>
        <div class="orb-ring"></div>
        <div class="orb" id="mainOrb" onclick="toggleOrb()"></div>
      </div>
      <div class="orb-label">TOCA EL NÚCLEO · ESCRIBE TU IDEA</div>
      <div class="orb-status" id="orbStatus">OMNI-IA EN ESPERA</div>
      <div class="voice-input-area">
        <input
          class="voice-input"
          id="coreInput"
          type="text"
          placeholder="Escribe tu idea o pregunta aquí..."
          onkeydown="if(event.key==='Enter')sendCore()"
        />
        <button class="send-btn" onclick="sendCore()">▶</button>
      </div>
      <div class="core-response">
        <div class="response-box" id="coreResponse"></div>
      </div>
    </div>

    <!-- ══ SCREEN: CHAT ══ -->
    <div class="screen" id="screen-chat">
      <div class="chat-header">
        <span style="font-size:11px;color:var(--muted);font-family:'Share Tech Mono',monospace;letter-spacing:1px;">PERSONALIDAD:</span>
        <div class="personality-selector">
          <button class="persona-btn active" onclick="setPersona(this,'analítica y precisa')" >ANALÍTICA</button>
          <button class="persona-btn" onclick="setPersona(this,'estratégica y directa')">ESTRATÉGICA</button>
          <button class="persona-btn" onclick="setPersona(this,'empática y comprensiva')">EMPÁTICA</button>
          <button class="persona-btn" onclick="setPersona(this,'creativa e innovadora')">CREATIVA</button>
        </div>
      </div>
      <div class="chat-messages" id="chatMessages">
        <div class="msg ai">
          <div class="msg-sender">◎ OMNI-IA · ANALÍTICA</div>
          Hola. Soy tu consejera personal OMNI-IA. Puedo ayudarte con análisis de negocios, estrategias, consejos personales, planificación y cualquier tema que necesites. ¿En qué te puedo asistir hoy?
        </div>
      </div>
      <div class="chat-input-area">
        <textarea
          class="chat-input"
          id="chatInput"
          placeholder="Escribe tu mensaje..."
          onkeydown="if(event.key==='Enter'&&!event.shiftKey){event.preventDefault();sendChat()}"
        ></textarea>
        <button class="send-btn" onclick="sendChat()">▶</button>
      </div>
    </div>

    <!-- ══ SCREEN: DOCS ══ -->
    <div class="screen" id="screen-docs">
      <div class="docs-toolbar">
        <button class="tool-btn" onclick="copyDocOutput()">⎘ COPIAR</button>
        <button class="tool-btn" onclick="downloadDoc()">⬇ DESCARGAR .TXT</button>
        <div class="tool-sep"></div>
        <button class="tool-btn" onclick="clearDoc()">✕ LIMPIAR</button>
      </div>
      <div class="docs-main">
        <div class="docs-sidebar-panel">
          <h4>TIPO DE DOCUMENTO</h4>
          <button class="doc-type-btn active" onclick="setDocType(this,'contrato comercial')">Contrato Comercial</button>
          <button class="doc-type-btn" onclick="setDocType(this,'carta formal')">Carta Formal</button>
          <button class="doc-type-btn" onclick="setDocType(this,'informe ejecutivo')">Informe Ejecutivo</button>
          <button class="doc-type-btn" onclick="setDocType(this,'propuesta de negocio')">Propuesta de Negocio</button>
          <button class="doc-type-btn" onclick="setDocType(this,'plan de marketing')">Plan de Marketing</button>
          <button class="doc-type-btn" onclick="setDocType(this,'correo profesional')">Correo Profesional</button>
          <button class="doc-type-btn" onclick="setDocType(this,'curriculum vitae')">Curriculum Vitae</button>
          <button class="doc-type-btn" onclick="setDocType(this,'acuerdo de confidencialidad')">Acuerdo NDA</button>
          <button class="doc-type-btn" onclick="setDocType(this,'análisis FODA')">Análisis FODA</button>
          <button class="doc-type-btn" onclick="setDocType(this,'otro documento personalizado')">Otro...</button>
        </div>
        <div class="docs-editor-area">
          <textarea
            class="doc-prompt-input"
            id="docPrompt"
            placeholder="Describe qué necesitas en el documento... (ej: Contrato de servicio de diseño web entre mi empresa CubaTech y un cliente, valor $500)"
          ></textarea>
          <button class="generate-btn" onclick="generateDoc()">◈ GENERAR DOCUMENTO</button>
          <div class="doc-output empty" id="docOutput">
            [ EL DOCUMENTO GENERADO APARECERÁ AQUÍ ]
          </div>
        </div>
      </div>
    </div>

    <!-- ══ SCREEN: IMAGE ══ -->
    <div class="screen" id="screen-image">
      <div class="section-title">◉ GENERADOR DE IMÁGENES IA</div>
      <div class="image-controls">
        <textarea
          class="image-prompt-input"
          id="imagePrompt"
          placeholder="Describe la imagen que quieres crear... (ej: Un logo futurista de una empresa de tecnología cubana, colores cyan y dorado)"
        ></textarea>
        <div style="display:flex;flex-direction:column;gap:8px;">
          <div style="font-size:10px;color:var(--muted);font-family:'Share Tech Mono',monospace;letter-spacing:1px;">ESTILO:</div>
          <div class="image-styles" id="imageStyles">
            <button class="style-chip active" onclick="setStyle(this)">Fotorealista</button>
            <button class="style-chip" onclick="setStyle(this)">Arte Digital</button>
            <button class="style-chip" onclick="setStyle(this)">Cinematográfico</button>
            <button class="style-chip" onclick="setStyle(this)">Minimalista</button>
            <button class="style-chip" onclick="setStyle(this)">Cyberpunk</button>
            <button class="style-chip" onclick="setStyle(this)">Ilustración</button>
            <button class="style-chip" onclick="setStyle(this)">Logo Profesional</button>
            <button class="style-chip" onclick="setStyle(this)">Acuarela</button>
          </div>
          <button class="generate-btn" onclick="generateImage()">◉ CREAR IMAGEN</button>
        </div>
      </div>
      <div class="image-result" id="imageResult">
        <div class="image-placeholder" id="imagePlaceholder">
          <div class="icon">◉</div>
          <div>La imagen aparecerá aquí</div>
          <div style="margin-top:8px;font-size:10px;opacity:0.6;">Conecta tu API de Pollinations o similar</div>
        </div>
      </div>
      <div id="imageDesc" style="font-size:13px;color:var(--muted);line-height:1.6;display:none;"></div>
    </div>

    <!-- ══ SCREEN: FINANCE ══ -->
    <div class="screen" id="screen-finance">
      <div class="section-title">◬ ARQUITECTO FINANCIERO ESTRATÉGICO</div>
      <div class="finance-grid">
        <div class="finance-card">
          <h4>AHORRO SUGERIDO</h4>
          <div class="value" id="fin-ahorro">—</div>
          <div class="change">% de tus ingresos</div>
        </div>
        <div class="finance-card">
          <h4>ROI ESTIMADO</h4>
          <div class="value" id="fin-roi">—</div>
          <div class="change">anual proyectado</div>
        </div>
        <div class="finance-card">
          <h4>RIESGO</h4>
          <div class="value" id="fin-riesgo" style="color:var(--gold)">—</div>
          <div class="change">nivel de exposición</div>
        </div>
        <div class="finance-card">
          <h4>HORIZONTE</h4>
          <div class="value" id="fin-horizonte">—</div>
          <div class="change">plazo recomendado</div>
        </div>
      </div>
      <div class="finance-advice-area">
        <textarea id="financeInput" placeholder="Describe tu situación financiera o pregunta estratégica... (ej: Tengo $500 de ahorro. ¿Cómo los invierto para generar ingresos online desde Cuba?)"></textarea>
        <button class="generate-btn" onclick="getFinanceAdvice()">◬ ANALIZAR ESTRATEGIA</button>
        <div class="finance-output" id="financeOutput" style="color:var(--muted);font-family:'Share Tech Mono',monospace;font-size:11px;">[ ANÁLISIS FINANCIERO ESTRATÉGICO ]</div>
      </div>
    </div>

    <!-- ══ SCREEN: TRANSLATE ══ -->
    <div class="screen" id="screen-translate">
      <div style="display:flex;align-items:center;gap:12px;flex-wrap:wrap;">
        <div class="section-title" style="margin:0;">◐ TRADUCCIÓN UNIVERSAL</div>
        <button class="generate-btn" style="margin-left:auto;" onclick="doTranslate()">◐ TRADUCIR</button>
      </div>
      <div class="translate-grid">
        <div class="translate-panel">
          <select class="lang-select" id="sourceLang">
            <option value="español">Español</option>
            <option value="inglés">Inglés</option>
            <option value="francés">Francés</option>
            <option value="alemán">Alemán</option>
            <option value="portugués">Portugués</option>
            <option value="italiano">Italiano</option>
            <option value="chino">Chino</option>
            <option value="japonés">Japonés</option>
            <option value="árabe">Árabe</option>
            <option value="ruso">Ruso</option>
          </select>
          <textarea
            class="translate-text"
            id="translateInput"
            placeholder="Escribe el texto aquí..."
          ></textarea>
        </div>
        <div class="translate-panel">
          <select class="lang-select" id="targetLang">
            <option value="inglés">Inglés</option>
            <option value="español">Español</option>
            <option value="francés">Francés</option>
            <option value="alemán">Alemán</option>
            <option value="portugués">Portugués</option>
            <option value="italiano">Italiano</option>
            <option value="chino">Chino</option>
            <option value="japonés">Japonés</option>
            <option value="árabe">Árabe</option>
            <option value="ruso">Ruso</option>
          </select>
          <div class="translate-output" id="translateOutput" style="color:var(--muted);font-family:'Share Tech Mono',monospace;font-size:11px;">
            [ TRADUCCIÓN AQUÍ ]
          </div>
        </div>
      </div>
    </div>
  </main>
</div>

<!-- API MODAL -->
<div class="modal-overlay" id="modalOverlay">
  <div class="modal">
    <h3>⚙ CONFIGURAR API KEY</h3>
    <p>
      Para activar la inteligencia de OMNI-IA, necesitas una clave API gratuita de Google Gemini.<br><br>
      1. Ve a <a href="https://aistudio.google.com/app/apikey" target="_blank">aistudio.google.com/app/apikey</a><br>
      2. Crea una clave gratis (no requiere tarjeta)<br>
      3. Pégala aquí abajo
    </p>
    <input type="password" id="apiKeyInput" placeholder="AIza..." />
    <div class="modal-btns">
      <button class="modal-cancel" onclick="closeModal()">CANCELAR</button>
      <button class="modal-save" onclick="saveApiKey()">GUARDAR</button>
    </div>
  </div>
</div>

<script>
// ══ STATE ══
let apiKey = localStorage.getItem('omni_api_key') || '';
let currentPersona = 'analítica y precisa';
let currentDocType = 'contrato comercial';
let currentImageStyle = 'Fotorealista';
let chatHistory = [];

// ══ NAVIGATION ══
const screenTitles = {
  core: 'NÚCLEO DE INTERACCIÓN',
  chat: 'CONSEJERA ADAPTATIVA',
  docs: 'GENERADOR DE DOCUMENTOS',
  image: 'FORJA CREATIVA · IMÁGENES IA',
  finance: 'ARQUITECTO FINANCIERO',
  translate: 'TRADUCCIÓN UNIVERSAL'
};

function showScreen(id) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
  document.getElementById('screen-' + id).classList.add('active');
  document.getElementById('nav-' + id).classList.add('active');
  document.getElementById('topbar-title').textContent = screenTitles[id];
}

// ══ API MODAL ══
function openModal() {
  document.getElementById('apiKeyInput').value = apiKey;
  document.getElementById('modalOverlay').classList.add('open');
}
function closeModal() {
  document.getElementById('modalOverlay').classList.remove('open');
}
function saveApiKey() {
  apiKey = document.getElementById('apiKeyInput').value.trim();
  localStorage.setItem('omni_api_key', apiKey);
  closeModal();
  setOrbStatus('✓ API CONECTADA · SISTEMA LISTO');
}

// ══ GEMINI API CALL ══
async function callGemini(prompt, systemInstruction = '') {
  if (!apiKey) {
    openModal();
    throw new Error('API Key requerida');
  }

  const messages = systemInstruction
    ? [{ role: 'user', parts: [{ text: systemInstruction + '\n\n' + prompt }] }]
    : [{ role: 'user', parts: [{ text: prompt }] }];

  const response = await fetch(
    `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${apiKey}`,
    {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ contents: messages })
    }
  );

  if (!response.ok) {
    const err = await response.json();
    throw new Error(err.error?.message || 'Error de API');
  }

  const data = await response.json();
  return data.candidates?.[0]?.content?.parts?.[0]?.text || 'Sin respuesta';
}

async function callGeminiChat(messages) {
  if (!apiKey) { openModal(); throw new Error('API Key requerida'); }

  const response = await fetch(
    `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${apiKey}`,
    {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ contents: messages })
    }
  );

  if (!response.ok) {
    const err = await response.json();
    throw new Error(err.error?.message || 'Error de API');
  }

  const data = await response.json();
  return data.candidates?.[0]?.content?.parts?.[0]?.text || 'Sin respuesta';
}

// ══ CORE SCREEN ══
function toggleOrb() {
  const orb = document.getElementById('mainOrb');
  orb.classList.toggle('listening');
  const isListening = orb.classList.contains('listening');
  setOrbStatus(isListening ? 'ESCUCHANDO...' : 'OMNI-IA EN ESPERA');
  if (isListening) document.getElementById('coreInput').focus();
}

function setOrbStatus(text) {
  document.getElementById('orbStatus').textContent = text;
}

async function sendCore() {
  const input = document.getElementById('coreInput');
  const text = input.value.trim();
  if (!text) return;

  const orb = document.getElementById('mainOrb');
  orb.classList.add('listening');
  setOrbStatus('PROCESANDO...');
  input.value = '';

  const responseBox = document.getElementById('coreResponse');
  responseBox.classList.add('visible');
  responseBox.textContent = 'Analizando...';

  try {
    const result = await callGemini(text,
      'Eres OMNI-IA, un asistente de inteligencia artificial avanzado. Responde de forma concisa, útil y directa en español. Eres un experto en negocios, tecnología, finanzas, estrategia y creatividad.'
    );
    responseBox.textContent = result;
    setOrbStatus('✓ RESPUESTA LISTA');
  } catch(e) {
    responseBox.textContent = '⚠ ' + e.message;
    setOrbStatus('ERROR · VERIFICA API KEY');
  }

  orb.classList.remove('listening');
}

// ══ CHAT SCREEN ══
function setPersona(btn, persona) {
  document.querySelectorAll('.persona-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  currentPersona = persona;
}

async function sendChat() {
  const input = document.getElementById('chatInput');
  const text = input.value.trim();
  if (!text) return;
  input.value = '';

  const messages = document.getElementById('chatMessages');

  // User message
  const userMsg = document.createElement('div');
  userMsg.className = 'msg user';
  userMsg.textContent = text;
  messages.appendChild(userMsg);

  // Thinking
  const thinking = document.createElement('div');
  thinking.className = 'msg thinking';
  thinking.innerHTML = '<span class="thinking-dots">PROCESANDO</span>';
  messages.appendChild(thinking);
  messages.scrollTop = messages.scrollHeight;

  // Build history
  chatHistory.push({ role: 'user', parts: [{ text }] });

  const systemCtx = `Eres OMNI-IA, una consejera personal con personalidad ${currentPersona}. 
Ayudas con negocios, finanzas, estrategia, vida personal y cualquier tema. 
Respondes siempre en español, de forma clara y útil. Adaptas tu tono a tu personalidad actual.`;

  const allMessages = [
    { role: 'user', parts: [{ text: systemCtx + '\n\nConfirma que entiendes.' }] },
    { role: 'model', parts: [{ text: 'Entendido. Estoy listo como tu consejera OMNI-IA.' }] },
    ...chatHistory
  ];

  try {
    const result = await callGeminiChat(allMessages);
    chatHistory.push({ role: 'model', parts: [{ text: result }] });

    thinking.remove();
    const aiMsg = document.createElement('div');
    aiMsg.className = 'msg ai';
    aiMsg.innerHTML = `<div class="msg-sender">◎ OMNI-IA · ${currentPersona.toUpperCase().split(' ')[0]}</div>${result}`;
    messages.appendChild(aiMsg);
  } catch(e) {
    thinking.remove();
    const errMsg = document.createElement('div');
    errMsg.className = 'msg ai';
    errMsg.innerHTML = `<div class="msg-sender">◎ ERROR</div>⚠ ${e.message}`;
    messages.appendChild(errMsg);
  }

  messages.scrollTop = messages.scrollHeight;
}

// ══ DOCS SCREEN ══
function setDocType(btn, type) {
  document.querySelectorAll('.doc-type-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  currentDocType = type;
}

async function generateDoc() {
  const prompt = document.getElementById('docPrompt').value.trim();
  const output = document.getElementById('docOutput');

  if (!prompt) {
    output.classList.remove('empty');
    output.textContent = '⚠ Describe qué necesitas en el documento.';
    return;
  }

  output.classList.remove('empty');
  output.textContent = 'Generando documento...';

  try {
    const result = await callGemini(
      `Crea un ${currentDocType} profesional y completo basado en esta descripción: ${prompt}`,
      'Eres un abogado y redactor profesional experto. Genera documentos completos, formales y bien estructurados en español. Incluye todas las secciones necesarias para un documento profesional.'
    );
    output.textContent = result;
  } catch(e) {
    output.textContent = '⚠ ' + e.message;
  }
}

function copyDocOutput() {
  const text = document.getElementById('docOutput').textContent;
  navigator.clipboard.writeText(text).then(() => alert('✓ Copiado al portapapeles'));
}

function downloadDoc() {
  const text = document.getElementById('docOutput').textContent;
  const blob = new Blob([text], { type: 'text/plain;charset=utf-8' });
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = `OMNI-IA_documento_${Date.now()}.txt`;
  a.click();
}

function clearDoc() {
  document.getElementById('docOutput').textContent = '[ EL DOCUMENTO GENERADO APARECERÁ AQUÍ ]';
  document.getElementById('docOutput').classList.add('empty');
  document.getElementById('docPrompt').value = '';
}

// ══ IMAGE SCREEN ══
function setStyle(btn) {
  document.querySelectorAll('.style-chip').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  currentImageStyle = btn.textContent;
}

async function generateImage() {
  const prompt = document.getElementById('imagePrompt').value.trim();
  if (!prompt) return;

  const result = document.getElementById('imageResult');
  const placeholder = document.getElementById('imagePlaceholder');
  const desc = document.getElementById('imageDesc');

  placeholder.innerHTML = '<div class="icon" style="animation:orb-breathe 1s infinite">◉</div><div>Generando imagen...</div>';

  // Use Pollinations AI (free, no API key needed)
  const fullPrompt = encodeURIComponent(`${prompt}, style: ${currentImageStyle}, high quality, detailed`);
  const imageUrl = `https://image.pollinations.ai/prompt/${fullPrompt}?width=800&height=500&nologo=true&model=flux`;

  const img = new Image();
  img.onload = () => {
    result.innerHTML = '';
    img.style.cssText = 'width:100%;height:100%;object-fit:contain;border-radius:8px;';
    result.appendChild(img);

    desc.style.display = 'block';
    desc.textContent = `◉ Imagen generada · Estilo: ${currentImageStyle} · ${new Date().toLocaleTimeString()}`;
  };
  img.onerror = async () => {
    // Fallback: generate description with Gemini
    try {
      const description = await callGemini(
        `Describe en detalle cómo sería esta imagen: "${prompt}" en estilo ${currentImageStyle}. Sé muy visual y descriptivo.`,
        'Eres un director de arte. Describe imágenes de forma vívida y detallada.'
      );
      result.innerHTML = '';
      const descBox = document.createElement('div');
      descBox.style.cssText = 'padding:24px;font-size:14px;line-height:1.8;color:var(--text);text-align:center;';
      descBox.innerHTML = `<div style="font-size:10px;color:var(--muted);font-family:\'Share Tech Mono\',monospace;letter-spacing:1px;margin-bottom:16px;">◉ VISUALIZACIÓN IA (DESCRIPCIÓN)</div>${description}`;
      result.appendChild(descBox);
    } catch(e) {
      placeholder.innerHTML = `<div>⚠ ${e.message}</div>`;
    }
  };
  img.src = imageUrl;
}

// ══ FINANCE SCREEN ══
async function getFinanceAdvice() {
  const input = document.getElementById('financeInput').value.trim();
  const output = document.getElementById('financeOutput');

  if (!input) return;

  output.style.color = 'var(--muted)';
  output.style.fontFamily = "'Share Tech Mono', monospace";
  output.textContent = 'Analizando estrategia financiera...';

  try {
    const result = await callGemini(input,
      `Eres un asesor financiero experto especializado en economías emergentes y negocios digitales. 
El usuario está en Cuba. Proporciona estrategias financieras prácticas, reales y aplicables. 
Al inicio de tu respuesta, en una línea separada, incluye estos 4 datos en formato JSON exacto:
{"ahorro":"X%","roi":"X%","riesgo":"BAJO/MEDIO/ALTO","horizonte":"X meses/años"}
Luego da tu análisis completo en español.`
    );

    // Try to extract JSON metrics
    const jsonMatch = result.match(/\{[^}]+\}/);
    if (jsonMatch) {
      try {
        const metrics = JSON.parse(jsonMatch[0]);
        document.getElementById('fin-ahorro').textContent = metrics.ahorro || '—';
        document.getElementById('fin-roi').textContent = metrics.roi || '—';
        document.getElementById('fin-riesgo').textContent = metrics.riesgo || '—';
        document.getElementById('fin-horizonte').textContent = metrics.horizonte || '—';
      } catch(e) {}
    }

    output.style.color = 'var(--text)';
    output.style.fontFamily = "'Rajdhani', sans-serif";
    output.textContent = result.replace(/\{[^}]+\}/, '').trim();
  } catch(e) {
    output.textContent = '⚠ ' + e.message;
  }
}

// ══ TRANSLATE SCREEN ══
async function doTranslate() {
  const text = document.getElementById('translateInput').value.trim();
  const source = document.getElementById('sourceLang').value;
  const target = document.getElementById('targetLang').value;
  const output = document.getElementById('translateOutput');

  if (!text) return;

  output.style.color = 'var(--muted)';
  output.style.fontFamily = "'Share Tech Mono', monospace";
  output.textContent = 'Traduciendo...';

  try {
    const result = await callGemini(
      `Traduce el siguiente texto de ${source} a ${target}. Devuelve SOLO la traducción, sin explicaciones ni notas:\n\n${text}`
    );
    output.style.color = 'var(--text)';
    output.style.fontFamily = "'Rajdhani', sans-serif";
    output.textContent = result;
  } catch(e) {
    output.textContent = '⚠ ' + e.message;
  }
}

// ══ INIT ══
if (apiKey) {
  setOrbStatus('SISTEMA LISTO · API CONECTADA');
} else {
  setOrbStatus('TOCA ⚙ API KEY PARA ACTIVAR');
}

// Close modal on overlay click
document.getElementById('modalOverlay').addEventListener('click', function(e) {
  if (e.target === this) closeModal();
});

// Enter key on translate
document.addEventListener('keydown', function(e) {
  if (e.key === 'Enter' && e.ctrlKey) {
    const activeScreen = document.querySelector('.screen.active');
    if (activeScreen.id === 'screen-translate') doTranslate();
  }
});
</script>
</body>
</html>
